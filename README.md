# Pegas Alias
Игра, разрабатываемая в рамках 2 модуля курса Middle Frontend-разработчик Яндекс.Практикума. 
Авторы: [`Ярослав Старущенко`](https://github.com/ururustaru), [`Сергей Сапронов`](https://github.com/Bezumstvo), 
[`Алексей Пилин`](https://github.com/AlexPilinni), [`Владислав Мищенко`](https://github.com/Wagerend), [`Михаил Зотов`](https://github.com/gremwiz1)

Макет:

[![ССЫЛКА НА МАКЕТ](/packages/client/src/assets/images/cover.png)](https://www.figma.com/file/RKweSA7ACSKOBtML4O6LhC/Pegas-Alias)

## Механика игры
Pegas Alias - игра, рассчитанная на 4 - 16 игроков, где игроки делятся на несколько команд по 2 или более участников 
и пытаются за отведённое время объяснить партнёрам по команде предложенные игрой слова синонимами и другими словами, не 
употребляя однокоренные или иностранные слова, а также не используя жесты. В каждом раунде слова отгадывают только 
партнёры по команде, время раунда устанавливается в начале игры.

В начале игры необходимо определить количество и названия команд, выбрать сложность слов, установить 
время раунда и количество очков, необходимых для победы. Можно установить опцию, что последнее слово по истечении
раунда отгадывается не только партнёрами по команде, но и всеми командами. В таком случае, если слово отгадает 
другая команда, ей достанется 1 очко.

В начале каждого раунда игра подскажет, какая команда играет следующей и покажет текущий счёт игры. Сейчас 3 раунд, 
"Бетмены" выигрывают у "Суперменов" 18-11, следующими играют "Супермены". Катя из команды "Супермены" берет 
устройство с игрой и готовится объяснять слова. Нажав на "Начать раунд", запускается таймер и на экране показываются 
слова, которые нужно объяснить её партнёру Лере другими словами. 
- Когда Лера отгадывает, Катя нажимает кнопку "Отгадали". За это слово Супермены получат **1 очко**
- Когда не отгадывает или если Катя нарушила правила игры (произнесла однокоренное слово или перевод, 
использовала жесты для объяснения), тогда Кате придется нажать кнопку "Не отгадали". Пример однокоренного слова: на 
карточке "Луноход", Катя сказала "Транспорт, который ходит по Луне" - тут целых 2 однокоренных слова :( Стоило 
  сказать "Машина, которая ездит по спутнику Земли". Если нажата кнопка "Не отгадали", то команда получит **-1 очко**.
- Если Катя не знает слова на экране, можно нажать "Не знаю слова". В этом случае слово пропустится, Суперменам 
  ничего не будет (**0 очков за слово**).

По истечении времени раунда будет показан итог круга, где можно посмотреть отгаданные и пропущенные командой слова, 
отредактировать результаты в случае ошибки или спорной ситуации, а также посмотреть значение того или иного слова, 
которое объяснялось в раунде. Игра длится раунд за раундом, пока одна из команд не достигнет установленного 
количества очков.

При вводе названия команды можно выбрать команду из списка, если она уже играла. Для одной и той же команды 
записывается единая статистика по отгаданным словам, сыгранным играм и процентам побед. На отдельном экране можно 
посмотреть статистку команд, которые играли на этом устройстве.


### Как запускать?
1. Убедитесь что у вас установлен `node` и `docker`
2. Выполните команду `yarn bootstrap` - это обязательный шаг, без него ничего работать не будет :)
3. Выполните команду `yarn dev`
4. Выполните команду `yarn dev --scope=client` чтобы запустить только клиент
5. Выполните команду `yarn dev --scope=server` чтобы запустить только server


## Другие команды
- `yarn test` - тесты (используется [`react-testing-library`](https://testing-library.com/docs/react-testing-library/intro/))
- `yarn lint` - линтинг
- `yarn format` - форматирование prettier
- `yarn build` - сборка проекта


### Как добавить зависимости?
В этом проекте используется `monorepo` на основе [`lerna`](https://github.com/lerna/lerna)

Чтобы добавить зависимость для клиента 
```yarn lerna add {your_dep} --scope client```

Для сервера
```yarn lerna add {your_dep} --scope server```

И для клиента и для сервера
```yarn lerna add {your_dep}```

Если вы хотите добавить dev зависимость, проделайте то же самое, но с флагом `dev`
```yarn lerna add {your_dep} --dev --scope server```


### Production окружение в докере
Перед первым запуском выполните `node init.js`

`docker compose up` - запустит три сервиса
1. nginx, раздающий клиентскую статику (client)
2. node, ваш сервер (server)
3. postgres, вашу базу данных (postgres)

Если вам понадобится только один сервис, просто уточните какой в команде
`docker compose up {sevice_name}`, например `docker compose up server`


### Развёртывание на сервере

1. `sudo apt update` 
2. `apt install nodejs` 
3. установить docker: [инструкция для Ubuntu](https://docs.docker.com/engine/install/ubuntu/)
4. `apt install docker-compose`
5. создать папку проекта, `git init` в папке
6. `git remote add origin git@github.com:pegas-alias/pegas-alias.git`, сделать pull 
7. `apt install npm`, `npm install yarn -g`, `yarn bootstrap` из папки проекта
8. `sudo apt update`
9. `sudo apt install nginx`
10. `node -v`. Если версия ниже 16, то `curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.2/install.sh | 
    bash`. `nvm install 18`, `nvm use 18`
11. `docker compose build`
12. `docker compose up`
13. `docker start postgres_container`, `docker start prakticum-app` -> приложение запустится за 3001 порту


## Стек
- `vite` - упаковщик приложения
- `react + redux` - фреймворк приложения
- `typescript` - типизация javascript
- `jest` - тестирование
- `scss + cssnano` - препроцессор стилей + оптимизация
- `eslint` - линтинг ошибок
- `axios` - обработка запросов
- `express` - в качестве сервера
- `postgres + sequelize` - база данных
- `prettier` - форматирование
- `dompurify` - для санитайза сырого html
